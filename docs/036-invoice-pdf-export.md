# チケット036: 請求書PDF出力機能

## 概要
請求書をPDF形式で出力する機能を実装。印刷用のフォーマットで、A4サイズに最適化されたレイアウトを提供。

## 要件

### 機能要件
1. **PDF生成**
   - 請求書詳細画面にPDF出力ボタン
   - A4サイズ（210mm × 297mm）対応
   - 日本語フォント対応
   - ロゴ画像の埋め込み（オプション）

2. **レイアウト**
   - ヘッダー：自社情報
   - タイトル：「請求書」
   - 請求先情報
   - 請求書番号・発行日
   - 明細テーブル
   - 金額サマリー（小計・税・合計）
   - フッター：備考欄

3. **出力オプション**
   - プレビュー機能
   - ダウンロード
   - 印刷プレビュー
   - ファイル名：`請求書_INV-YYYYMMDD-0001.pdf`

### 技術選定
```javascript
// オプション1: react-pdf
import { PDFDownloadLink, Document, Page } from '@react-pdf/renderer';

// オプション2: jsPDF
import jsPDF from 'jspdf';

// オプション3: Puppeteer (サーバーサイド)
// より高品質だが、サーバー負荷が高い
```

### PDFレイアウト仕様
```
┌─────────────────────────────────┐
│ [ロゴ] 株式会社○○              │
│        〒123-4567                │
│        東京都...                 │
│        TEL: 03-1234-5678         │
├─────────────────────────────────┤
│          請 求 書                │
├─────────────────────────────────┤
│ ○○株式会社 御中                │
│                                  │
│ 請求書番号: INV-20250101-0001    │
│ 発行日: 2025年1月1日             │
├─────────────────────────────────┤
│ No│品目    │数量│単価  │金額   │
│ 1 │商品A   │ 2  │1,000 │2,000  │
│ 2 │商品B   │ 1  │3,000 │3,000  │
├─────────────────────────────────┤
│                 小計: 5,000円    │
│                 消費税: 500円    │
│                 合計: 5,500円    │
└─────────────────────────────────┘
```

## タスク

### 技術調査
- [ ] PDFライブラリの選定
- [ ] 日本語フォント対応調査
- [ ] パフォーマンス検証

### バックエンド実装
- [ ] PDF生成API（サーバーサイド生成の場合）
- [ ] テンプレート管理
- [ ] キャッシュ機能

### フロントエンド実装
- [ ] PDF出力ボタン
- [ ] プレビューモーダル
- [ ] PDFレイアウトコンポーネント
- [ ] スタイル調整

### 最適化
- [ ] ファイルサイズ最適化
- [ ] 生成速度改善
- [ ] メモリ使用量削減

### テスト
- [ ] 各ブラウザでの動作確認
- [ ] 日本語表示テスト
- [ ] 大量明細時のレイアウト
- [ ] 印刷プレビュー確認

## 成功基準
- [ ] PDFが正常に生成される
- [ ] 日本語が正しく表示される
- [ ] A4サイズで適切にレイアウトされる
- [ ] 3秒以内にPDFが生成される
- [ ] ダウンロードが正常に動作する

## 注意事項
- 日本語フォントのライセンス確認
- ファイルサイズは5MB以下を目標
- ブラウザ互換性の確認
- セキュリティ（XSS対策）

## 依存関係
- PDFライブラリ（react-pdf or jsPDF）
- 日本語フォント
- 請求書詳細データ